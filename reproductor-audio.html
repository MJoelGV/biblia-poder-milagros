<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblia en Audio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .selectors {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        select {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
            min-width: 180px;
        }
        .player-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        #now-playing {
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            color: #2c3e50;
            min-height: 27px;
        }
        audio {
            width: 100%;
            margin-top: 20px;
        }
        @ (max-width: 600px) {
            .selectors {
                flex-direction: column;
            }
            select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>Biblia en Audio</h1>
    
    <div class="container">
        <div class="selectors">
            <select id="book-select">
                <option value="">Selecciona un libro</option>
            </select>
            <select id="chapter-select" disabled>
                <option value="">Selecciona un capítulo</option>
            </select>
        </div>
        
        <div id="now-playing"></div>
        
        <div class="player-controls">
            <button id="play-button" disabled>Reproducir</button>
            <button id="stop-button" disabled>Detener</button>
        </div>
        
        <audio id="audio-player"></audio>
    </div>

    <script>
        // Mapeo de códigos de libros a nombres completos
        const bookNames = {
            'genesis': 'Génesis', 'exodus': 'Éxodo', 'lev': 'Levítico', 'num': 'Números', 'deu': 'Deuteronomio',
            'joshua': 'Josué', 'judges': 'Jueces', 'ruth': 'Rut', '1sam': '1 Samuel', '2sam': '2 Samuel',
            '1kin': '1 Reyes', '2kin': '2 Reyes', '1chron': '1 Crónicas', '2chron': '2 Crónicas',
            'ezra': 'Esdras', 'nehemiah': 'Nehemías', 'esther': 'Ester', 'job': 'Job', 'psalm': 'Salmos',
            'proverbs': 'Proverbios', 'ecc': 'Eclesiastés', 'song': 'Cantares', 'isaiah': 'Isaías', 'jere': 'Jeremías',
            'lam': 'Lamentaciones', 'ezek': 'Ezequiel', 'dan': 'Daniel', 'hosea': 'Oseas', 'joel': 'Joel', 
            'amos': 'Amós', 'oba': 'Abdías', 'jonah': 'Jonás', 'micah': 'Miqueas', 'nahum': 'Nahúm', 
            'habak': 'Habacuc', 'zeph': 'Sofonías', 'haggai': 'Hageo', 'zech': 'Zacarías', 'mal': 'Malaquías',
            'matt': 'Mateo', 'mark': 'Marcos', 'luke': 'Lucas', 'john': 'Juan', 'acts': 'Hechos', 
            'romans': 'Romanos', '1cor': '1 Corintios', '2cor': '2 Corintios', 'gal': 'Gálatas',
            'eph': 'Efesios', 'phil': 'Filipenses', 'col': 'Colosenses', '1the': '1 Tesalonicenses', 
            '2the': '2 Tesalonicenses', '1tim': '1 Timoteo', '2tim': '2 Timoteo', 'tit': 'Tito', 
            'philem': 'Filemón', 'heb': 'Hebreos', 'jam': 'Santiago', '1pet': '1 Pedro', '2pet': '2 Pedro', 
            '1joh': '1 Juan', '2joh': '2 Juan', '3joh': '3 Juan', 'jude': 'Judas', 'rev': 'Apocalipsis'
        };

        // Mapeo de códigos de libros a sus nombres de archivo
        const bookFileNames = {
            'genesis': 'genesis', 'exodus': 'exodus', 'lev': 'lev', 'num': 'num', 'deu': 'deu',
            'joshua': 'joshua', 'judges': 'judges', 'ruth': 'ruth', '1sam': '1sam', '2sam': '2sam',
            '1kin': '1kin', '2kin': '2kin', '1chron': '1chron', '2chron': '2chron',
            'ezra': 'ezra', 'nehemiah': 'nehemiah', 'esther': 'esther', 'job': 'job', 'psalm': 'psalm',
            'proverbs': 'proverbs', 'ecc': 'ecc', 'song': 'song', 'isaiah': 'isaiah', 'jere': 'jere',
            'lam': 'lam', 'ezek': 'ezek', 'dan': 'dan', 'hosea': 'hosea', 'joel': 'joel',
            'amos': 'amos', 'oba': 'oba', 'jonah': 'jonah', 'micah': 'micah', 'nahum': 'nahum',
            'habak': 'habak', 'zeph': 'zeph', 'haggai': 'haggai', 'zech': 'zech', 'mal': 'mal',
            'matt': 'matt', 'mark': 'mark', 'luke': 'luke', 'john': 'john', 'acts': 'acts',
            'romans': 'romans', '1cor': '1cor', '2cor': '2cor', 'gal': 'gal',
            'eph': 'eph', 'phil': 'phil', 'col': 'col', '1the': '1the',
            '2the': '2the', '1tim': '1tim', '2tim': '2tim', 'tit': 'tit',
            'philem': 'philem', 'heb': 'heb', 'jam': 'jam', '1pet': '1pet', '2pet': '2pet',
            '1joh': '1joh', '2joh': '2joh', '3joh': '3joh', 'jude': 'jude', 'rev': 'rev'
        };

        // Orden canónico de los libros
        const canonicalOrder = [
            'genesis', 'exodus', 'lev', 'num', 'deu', 'joshua', 'judges', 'ruth', '1sam', '2sam',
            '1kin', '2kin', '1chron', '2chron', 'ezra', 'nehemiah', 'esther', 'job', 'psalm', 'proverbs',
            'ecc', 'song', 'isaiah', 'jere', 'lam', 'ezek', 'dan', 'hosea', 'joel', 'amos', 'oba', 'jonah',
            'micah', 'nahum', 'habak', 'zeph', 'haggai', 'zech', 'mal', 'matt', 'mark', 'luke', 'john',
            'acts', 'romans', '1cor', '2cor', 'gal', 'eph', 'phil', 'col', '1the', '2the', '1tim', '2tim',
            'tit', 'philem', 'heb', 'jam', '1pet', '2pet', '1joh', '2joh', '3joh', 'jude', 'rev'
        ];

        // Elementos del DOM
        const bookSelect = document.getElementById('book-select');
        const chapterSelect = document.getElementById('chapter-select');
        const playButton = document.getElementById('play-button');
        const stopButton = document.getElementById('stop-button');
        const audioPlayer = document.getElementById('audio-player');
        const nowPlaying = document.getElementById('now-playing');

        // Cargar libros en el selector
        function loadBooks() {
            // Ordenar los libros según el orden canónico
            canonicalOrder.forEach(bookId => {
                if (bookNames[bookId]) {
                    const option = document.createElement('option');
                    option.value = bookId;
                    option.textContent = bookNames[bookId];
                    bookSelect.appendChild(option);
                }
            });
        }

        // Cargar capítulos cuando se selecciona un libro
        bookSelect.addEventListener('change', () => {
            const selectedBook = bookSelect.value;
            
            // Limpiar selector de capítulos
            chapterSelect.innerHTML = '<option value="">Selecciona un capítulo</option>';
            chapterSelect.disabled = !selectedBook;
            playButton.disabled = true;
            
            if (selectedBook) {
                // En un caso real, aquí podrías hacer una petición al servidor
                // para obtener los capítulos disponibles. Por ahora, asumimos que hay hasta 50 capítulos.
                const maxChapters = 50;
                
                // Crear opciones de capítulos
                for (let i = 1; i <= maxChapters; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Capítulo ${i}`;
                    chapterSelect.appendChild(option);
                }
            }
        });

        // Habilitar botón de reproducción cuando se selecciona un capítulo
        chapterSelect.addEventListener('change', () => {
            playButton.disabled = !chapterSelect.value;
        });

        // Reproducir el capítulo seleccionado
        playButton.addEventListener('click', () => {
            const book = bookSelect.value;
            const chapter = chapterSelect.value.padStart(2, '0'); // Asegurar 2 dígitos
            
            // Obtener el nombre de archivo correcto para el libro
            const bookFileName = bookFileNames[book];
            // Construir la ruta del archivo de audio
            const audioPath = `audio/${bookFileName}_${chapter.padStart(2, '0')}.mp3`;
            
            // Actualizar la interfaz
            nowPlaying.textContent = `Cargando ${bookNames[book]} Capítulo ${chapter}...`;
            
            // Configurar el reproductor de audio
            audioPlayer.src = audioPath;
            
            // Intentar reproducir
            audioPlayer.play().then(() => {
                nowPlaying.textContent = `Reproduciendo: ${bookNames[book]} Capítulo ${chapter}`;
                stopButton.disabled = false;
            }).catch(error => {
                console.error('Error al reproducir el audio:', error);
                nowPlaying.textContent = `Error al cargar ${bookNames[book]} Capítulo ${chapter}`;
            });
        });

        // Detener la reproducción
        stopButton.addEventListener('click', () => {
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            nowPlaying.textContent = 'Reproducción detenida';
            stopButton.disabled = true;
        });

        // Cargar los libros al iniciar
        loadBooks();

        // Manejar errores de reproducción
        audioPlayer.addEventListener('error', () => {
            nowPlaying.textContent = 'Error: No se pudo cargar el archivo de audio';
            stopButton.disabled = true;
        });
    </script>
</body>
</html>
